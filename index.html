<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è—¥å±€ç›¤é»ç³»çµ± - é¡è‰²ä¿®å¾©ç‰ˆ</title>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Microsoft JhengHei", "Segoe UI", Roboto, sans-serif; background-color: #f3f4f6; }
        
        /* è¼¸å…¥æ¡†æ¨£å¼ */
        .input-box { 
            @apply w-full h-9 border border-gray-400 rounded mx-1 text-center text-lg font-bold outline-none transition-colors p-0; 
            -moz-appearance: textfield;
        }
        .input-box:focus { @apply ring-2 ring-blue-500 border-blue-500; }
        .input-box::-webkit-outer-spin-button,
        .input-box::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

        /* è¼¸å…¥æ¡†é¡è‰²ç‹€æ…‹ */
        .input-empty { @apply bg-white text-red-500 placeholder-red-300; }
        .input-filled { @apply bg-blue-50 text-black border-blue-300; }
        
        /* åŠ æ¸›æŒ‰éˆ• */
        .btn-unit { 
            @apply flex-shrink-0 w-9 h-9 flex items-center justify-center bg-gray-200 rounded font-bold text-xl text-gray-600 active:scale-95 select-none cursor-pointer hover:bg-gray-300 shadow-sm border border-gray-300; 
        }
        
        /* ç„¡åº«å­˜æŒ‰éˆ• */
        .btn-zero { 
            @apply mt-2 w-full text-xs bg-gray-600 text-white py-2 rounded shadow hover:bg-gray-700 active:bg-gray-800 active:scale-95 transition font-bold tracking-wide flex items-center justify-center gap-1; 
        }
    </style>
</head>
<body>

<div id="app" class="w-full max-w-3xl mx-auto min-h-screen bg-white shadow-xl flex flex-col border-x border-gray-200">

    <div v-if="currentPage === 'login'" class="flex-1 flex flex-col justify-center items-center p-8 bg-blue-50">
        <div class="w-full max-w-sm">
            <h1 class="text-3xl font-bold text-blue-800 text-center mb-2">è—¥å±€ç›¤é»ç³»çµ±</h1>
            <p class="text-center text-gray-500 mb-8">Zone A (é¡è‰²ä¿®å¾©ç‰ˆ)</p>
            
            <label class="block text-gray-700 text-sm font-bold mb-2">è«‹é¸æ“‡ç›¤é»äººå“¡</label>
            <select v-model="currentUser" class="w-full p-3 border rounded-lg bg-white shadow-sm text-lg mb-6 cursor-pointer hover:border-blue-500">
                <option disabled value="">-- è«‹é¸æ“‡ --</option>
                <option v-for="name in staffList" :value="name">{{ name }}</option>
            </select>

            <button @click="enterSystem" 
                :disabled="!currentUser"
                :class="{'opacity-50 cursor-not-allowed': !currentUser}"
                class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow hover:bg-blue-700 transition text-lg">
                é–‹å§‹ç›¤é»
            </button>
        </div>
    </div>

    <div v-else class="flex-1 flex flex-col h-screen overflow-hidden">
        <div class="bg-blue-700 p-3 text-white shadow-md z-10 shrink-0">
            <div class="flex justify-between items-center mb-3">
                <div class="font-bold text-lg truncate flex-1 pr-2">{{ currentUser }}</div>
                
                <button @click="checkAndExport" 
                    class="text-xs font-bold px-4 py-2 rounded shadow transition-colors flex items-center whitespace-nowrap flex-shrink-0 border border-white/20"
                    :class="uncountedCount > 0 ? 'bg-orange-500 hover:bg-orange-600' : 'bg-green-500 hover:bg-green-600'">
                    <span v-if="uncountedCount > 0">âš ï¸ æ”¯æ´åŒ¯å‡º ({{ uncountedCount }}æœªç›¤)</span>
                    <span v-else>âœ… åŒ¯å‡ºå®Œæ•´å ±è¡¨</span>
                </button>
            </div>
            
            <div class="w-full bg-blue-900 rounded-full h-2.5 mb-3 overflow-hidden border border-blue-600">
                <div class="bg-green-400 h-2.5 rounded-full transition-all duration-500" :style="{ width: progressPercent + '%' }"></div>
            </div>

            <div class="relative">
                <input v-model="searchQuery" type="text" placeholder="ğŸ” æœå°‹è—¥åæˆ–ä»£ç¢¼..." 
                       class="w-full px-3 py-2 rounded text-gray-800 outline-none shadow-inner focus:ring-2 focus:ring-blue-400">
            </div>
        </div>

        <div class="flex-1 overflow-y-auto p-2 bg-gray-100 pb-20">
            <div v-for="item in filteredInventory" :key="item.code" 
                 class="rounded-lg shadow mb-4 p-3 border-l-[8px] border transition-all duration-200"
                 :class="isItemComplete(item) 
                    ? 'bg-white border-green-500 border-l-green-600' 
                    : 'bg-red-50 border-red-300 border-l-red-500'">
                
                <div class="flex justify-between items-start mb-3 gap-2">
                    <div class="flex-1 min-w-0"> 
                        <div class="font-bold text-lg text-gray-800 leading-tight break-words">{{ item.name }}</div>
                        <div class="text-xs text-gray-500 font-mono mt-1 font-bold">
                            {{ item.code }} <span class="text-blue-600 bg-blue-100 px-1 rounded ml-1">{{ item.shelf }}</span>
                        </div>
                        <div class="mt-2 flex flex-wrap gap-1">
                            <span class="text-xs bg-white px-2 py-0.5 rounded text-gray-600 border border-gray-300">1{{ item.units.large.name }}={{ item.units.large.cap }}</span>
                            <span v-if="item.units.small.cap > 1" class="text-xs bg-white px-2 py-0.5 rounded text-gray-600 border border-gray-300">1{{ item.units.small.name }}={{ item.units.small.cap }}</span>
                        </div>
                    </div>
                    
                    <div class="flex-shrink-0 text-right flex flex-col items-end">
                        <div v-if="isItemComplete(item)" class="text-3xl font-bold text-green-600 leading-none">
                            {{ calculateTotal(item) }}
                        </div>
                        <div v-else class="text-xl font-bold text-red-500 animate-pulse leading-none">
                            æœªç›¤
                        </div>
                        <div class="text-[10px] text-gray-400 mb-1">ç¸½é¡†æ•¸</div>
                        
                        <button v-if="!isItemComplete(item)" @click="setAllZero(item)" class="btn-zero">
                            ğŸ—‘ï¸ ç„¡åº«å­˜(0)
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-2 rounded p-2 border"
                     :class="isItemComplete(item) ? 'bg-gray-50 border-gray-200' : 'bg-red-100/50 border-red-200'">
                    <div class="text-center">
                        <label class="text-xs text-gray-600 block mb-1 font-bold">{{ item.units.large.name }}</label>
                        <div class="flex items-center justify-center w-full">
                            <button class="btn-unit" @click="updateQty(item, 'large', -1)">-</button>
                            <input type="number" v-model.number="item.inputs.large" 
                                   :class="item.inputs.large === null ? 'input-empty' : 'input-filled'"
                                   class="input-box" placeholder="?">
                            <button class="btn-unit" @click="updateQty(item, 'large', 1)">+</button>
                        </div>
                    </div>

                    <div class="text-center" v-if="item.units.small.cap > 1">
                        <label class="text-xs text-gray-600 block mb-1 font-bold">{{ item.units.small.name }}</label>
                        <div class="flex items-center justify-center w-full">
                            <button class="btn-unit" @click="updateQty(item, 'small', -1)">-</button>
                            <input type="number" v-model.number="item.inputs.small" 
                                   :class="item.inputs.small === null ? 'input-empty' : 'input-filled'"
                                   class="input-box" placeholder="?">
                            <button class="btn-unit" @click="updateQty(item, 'small', 1)">+</button>
                        </div>
                    </div>

                    <div class="text-center">
                        <label class="text-xs text-gray-600 block mb-1 font-bold">é¡†/æ”¯</label>
                        <div class="flex items-center justify-center w-full">
                            <button class="btn-unit" @click="updateQty(item, 'loose', -1)">-</button>
                            <input type="number" v-model.number="item.inputs.loose" 
                                   :class="item.inputs.loose === null ? 'input-empty' : 'input-filled'"
                                   class="input-box" placeholder="?">
                            <button class="btn-unit" @click="updateQty(item, 'loose', 1)">+</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div v-if="filteredInventory.length === 0" class="text-center text-gray-400 mt-10">
                æ‰¾ä¸åˆ°ç›¸é—œè—¥å“
            </div>
            
        </div>
    </div>
</div>

<script>
const { createApp, ref, computed, onMounted, watch } = Vue;

// 1. åŸå§‹è³‡æ–™
const RAW_CSV_ZONE_A = `
ä»£ç¢¼,åç¨±,å€,é–€ç‰Œ,,(é‡/å¤§åŒ…è£),,,,(é‡/å°åŒ…è£),,,é›¶æ•£,é›¶æ•£,ç¸½è¨ˆ
INSI19,Ryzodeg,Aå°,å†°,,x,5,/ç›’,6,x,1,,,,6
RI-I99,Humulin R ,Aå°,å†°,,x,10,/æŸ,,x,1,,,,0
INSI03,Levemir ,Aå°,å†°,,x,5,/ç›’,,x,1,,,,0
INSI14,Novomix 30,Aå°,å†°,1,x,5,/ç›’,,x,1,,,,5
INSI13,NovoRapid ,Aå°,å†°,1,x,5,/ç›’,4,x,1,,,,9
INSI16,Toujeo ,Aå°,å†°,1,x,5,/ç›’,2,x,1,,,,7
INSI17,Tresiba,Aå°,å†°,,x,10,/æŸ,1,x,1,,,,1
AMIO12,Adarone,Aå°,èª¿A1,1,x,100,/ç›’,48,x,10,/æ’,23,,603
APIO00,Eliquis,Aå°,èª¿A1,5,x,56,/ç›’,1,x,14,/æ’,29,,323
EDOO01,Lixiana 30,Aå°,èª¿A1,5,x,28,/ç›’,0,x,7,/æ’,5,,145
EDOO02,LIXIANA 60,Aå°,èª¿A1,1,x,28,/ç›’,6,x,7,/æ’,4,,74
MEXO02,Meletin ,Aå°,èª¿A1,,x,500,/ç›’,2,x,10,/æ’,26,,46
NOLO00,Nolvadex,Aå°,èª¿A1,2,x,30,/ç›’,25,x,10,/æ’,8,,318
RYTO04,Rhynorm,Aå°,èª¿A1,,x,840,/ç›’,29,x,14,/æ’,5,,411
DROO00,Multaq,Aå°,èª¿A1,,x,60,/ç›’,,x,10,/æ’,15,,15
SITO05,SitaMet,Aå°,èª¿A1,,x,1000,/ç›’,15,x,10,/æ’,7,,157
EMPO00,Jardiance 10,Aå°,èª¿A2,,x,30,/ç›’,,x,10,/æ’,24,,24
DAPO01,Forxiga,Aå°,èª¿A2,1,x,28,/ç›’,,x,14,/æ’,12,,40
DABO00,Pradaxa 110mg ,Aå°,èª¿A2,1,x,60,/ç›’,,x,10,/æ’,12,,72
DABO01,Pradaxa 150mg ,Aå°,èª¿A2,,x,60,/ç›’,,x,10,/æ’,5,,5
MTXO01,Trexan,Aå°,èª¿A2,,x,100,/ç›’,11,x,1,,,,11
WARO08,Uwarin,Aå°,èª¿A2,,x,100,/ç›’,42,x,10,/æ’,7,,427
RIVO07,Xarelto 15,Aå°,èª¿A2,1,x,100,/ç›’,4,x,10,/æ’,4,,144
GLIO11,Amepiride ,Aå°,èª¿A3,4,x,100,/æŸ,4,x,10,/æ’,31,,471
GLXO00,Glyxambi,Aå°,èª¿A3,,x,30,/ç›’,12,x,10,/æ’,16,,136
SITO00,Januvia ,Aå°,èª¿A3,10,x,28,/ç›’,1,x,14,/æ’,0,,294
EMPO01,Jardiance 25,Aå°,èª¿A3,2,x,30,/ç›’,2,x,10,/æ’,12,,92
ACAO14,Litacarbose,Aå°,èª¿A3,,x,1000,/ç›’,25,x,10,/æ’,15,,265
PIOO25,Politone,Aå°,èª¿A3,,x,30,/ç›’,4,x,10,/æ’,7,,47
REPO09,Repaglinide ,Aå°,èª¿A3,4,x,150,/æŸ,14,x,15,/æ’,59,,869
GLMO01,Amamet,Aå°,èª¿A4,,x,1000,/ç›’,5,x,10,/æ’,8,,58
CAGO00,Canaglu,Aå°,èª¿A4,5,x,28,/ç›’,1,x,14,/æ’,12,,166
METO76,Eutomin,Aå°,èª¿A4,,x,100,/æŸ,10,x,10,/æ’,33,,133
METO61,Glucovance,Aå°,èª¿A4,10,x,30,/ç›’,1,x,15,/æ’,72,,387
METO83,Henformin,Aå°,èª¿A4,,x,500,/ç›’,1,x,10,/æ’,12,,22
LINO04,Trajenta 5mg,Aå°,èª¿A4,,x,30,/ç›’,41,x,10,/æ’,21,,431
XIGO00,Xigduo,Aå°,èª¿A4,1,x,56,/ç›’,0,x,7,/æ’,2,,58
UREO03,Wecoli,Aå°,èª¿A51,9,x,100,/æŸ,8,x,10,/æ’,47,,1027
OXYO00,Oxbu,Aå°,èª¿A51,0,x,280,/ç›’,26,x,14,/æ’,8,,372
SOLO17,Solin,Aå°,èª¿A51,2,x,28,/ç›’,3,x,14,/æ’,17,,115
TOLO09,Terodine,Aå°,èª¿A51,,x,100,/æŸ,,x,10,/æ’,,,0
RANO02,Acemet 60mg ,Aå°,èª¿A52,2,x,100,/æŸ,0,x,10,/æ’,13,,213
MELO11,Melicam,Aå°,èª¿A52,,x,500,/ç›’,26,x,10,/æ’,43,,303
KETO24,Painoff,Aå°,èª¿A52,,x,100,/ç›’,10,x,10,/æ’,14,,114
ACEO20,Tonlief ,Aå°,èª¿A52,3,x,100,/æŸ,,x,10,/æ’,12,,312
ETOO10,Etor,Aå°,èª¿A52,,x,70,/ç›’,12,x,7,/æ’,9,,93
MEFO09,Tonifen,Aå°,èª¿A53,,x,100,/åŒ…,,x,10,/æ’,,,0
DDAO02,Minirin Melt OD,Aå°,èª¿A61,9,x,30,/ç›’,1,x,10,/æ’,6,,286
BETO28,BETMIGA 50MG,Aå°,èª¿A61,5,x,28,/ç›’,,x,7,/æ’,5,,145
ALPO08,Alprazolam0.5mg,Aå°,èª¿Aç®¡4,,x,100,/æŸ,,x,10,/æ’,,,0
RIVO02,Clonopam 0.5 ,Aå°,èª¿Aç®¡4,2,x,100,/ç›’,0,x,10,/æ’,9,,209
DIAO29,Diapin 2mg,Aå°,èª¿Aç®¡4,,x,1000,/ç›’,9,x,10,/æ’,5,,95
FLUO66,Flupine,Aå°,èª¿Aç®¡4,,x,500,/ç›’,,x,250,/æŸ,128,,128
IMOO02,Imovane,Aå°,èª¿Aç®¡4,,x,14,/ç›’,,x,14,/æ’,1,,1
EURO02,Kinzolam,Aå°,èª¿Aç®¡4,,x,100,/ç›’,25,x,10,/æ’,12,,262
LEXO03,Lotan,Aå°,èª¿Aç®¡4,,x,100,/æŸ,12,x,10,/æ’,17,,137
LORO16,Lowen,Aå°,èª¿Aç®¡4,2,x,100,/æŸ,3,x,10,/æ’,22,,252
PHEO09,Phenobarbital ,Aå°,èª¿Aç®¡4,,x,100,/æŸ,57,x,10,/æ’,,,570
RIVO00,RIVOTRIL 2MG,Aå°,èª¿Aç®¡4,2,x,60,/ç›’,1,x,15,/æ’,15,,150
TRAO17,Tramed,Aå°,èª¿Aç®¡4,1,x,100,/æŸ,3,x,10,/æ’,13,,143
ZOLO07,Zolnox,Aå°,èª¿Aç®¡4,1,x,100,/ç›’,7,x,10,/æ’,7,,177
`;

const RAW_STAFF_CSV = `
äººå“¡åå–®
æ´ª ä¸€ ä»,å³ æƒ  ç ,é™³ ä½³ ç‘œ,å‡ƒ åš æ‡·,è”¡ å®š ç”«,éƒ­ ç›Š å®,å” ç‘‹ ç¬,åš´ å©‰ ç‘„,è‘‰ å§¿ é·°,é»ƒ å¿  å»‰
æ— ä¿Š æ°,æ— å­¸ æˆ,å¼µ ä¿Š å“²,é™³ å˜‰ çµ¨,å¼µ æ¹˜ ç‘œ,æ èˆ’ è,ç‹ è€€ éœ†,è©¹ æ¿¬ ç«¹,é»ƒ æŸ éŠ˜,é„§ åª› å¿ƒ
é™³ è– å®¹,æ— å»º å‹³,å³ è©© èŒµ,æ— è– é›…,é™³ å¦ è“,è§£ å¿— æ¬½,é™³ å‡± å¾®,èŠ æ¡‡ æ¾º,é»ƒ è‹¾ æ˜€,æ— é Œ æ™º
æ ç‘‹ è“,è¨± å‡± è,é‚± ç‘ ç²,é»ƒ æƒ  ç ,å»– æ…§ ä¼¶,åŠ‰ è‚² è±ª,ç‹ è²½ éˆ´,æ–‡ å° ç†
`;

function parseCSV(csvText) {
    const lines = csvText.trim().split('\n');
    const items = [];
    let startIdx = 0;
    for(let i=0; i<lines.length; i++) {
        if(lines[i].includes("ä»£ç¢¼") && lines[i].includes("åç¨±")) {
            startIdx = i + 1;
            break;
        }
    }

    for (let i = startIdx; i < lines.length; i++) {
        const parts = lines[i].split(',');
        if (parts.length < 5 || !parts[0]) continue;

        const code = parts[0].trim();
        const name = parts[1].trim();
        const shelf = parts[3].trim();

        let lgCap = 1, lgUnit = 'ç›’';
        if (parts[6] && !isNaN(parseInt(parts[6]))) {
            lgCap = parseInt(parts[6]);
            lgUnit = parts[7] ? parts[7].replace('/', '').replace('x', '') : 'ç›’';
        }

        let smCap = 1, smUnit = 'æ’';
        if (parts[10] && !isNaN(parseInt(parts[10]))) {
            smCap = parseInt(parts[10]);
            smUnit = parts[11] ? parts[11].replace('/', '').replace('x', '') : 'æ’';
        }
        
        items.push({
            code: code,
            name: name,
            shelf: shelf,
            units: {
                large: { name: lgUnit, cap: lgCap },
                small: { name: smUnit, cap: smCap },
                loose: { name: 'é¡†', cap: 1 }
            },
            inputs: { large: null, small: null, loose: null }
        });
    }
    return items;
}

function parseStaff(csvText) {
    const raw = csvText.replace('äººå“¡åå–®', '').replace(/\r\n/g, ',').replace(/\n/g, ',');
    return raw.split(',').map(s => s.trim()).filter(s => s.length > 0);
}

createApp({
    setup() {
        const currentPage = ref('login');
        const currentUser = ref('');
        const searchQuery = ref('');
        const staffList = ref([]);
        const inventory = ref([]);

        onMounted(() => {
            staffList.value = parseStaff(RAW_STAFF_CSV);
            const data = parseCSV(RAW_CSV_ZONE_A);
            
            // ä½¿ç”¨ v9 é¿å…èˆŠè¨­å®šå¹²æ“¾
            const savedData = localStorage.getItem('pharmacy_inventory_v9'); 
            if (savedData) {
                const savedInputs = JSON.parse(savedData);
                data.forEach(item => {
                    if(savedInputs[item.code]) {
                        item.inputs = savedInputs[item.code];
                    }
                });
            }
            inventory.value = data;
        });

        const enterSystem = () => {
            if (currentUser.value) {
                currentPage.value = 'inventory';
            }
        };

        const isItemComplete = (item) => {
            const l = item.inputs.large !== null;
            const s = item.units.small.cap > 1 ? item.inputs.small !== null : true;
            const loose = item.inputs.loose !== null;
            return l && s && loose;
        };

        const calculateTotal = (item) => {
            if (!isItemComplete(item)) return 0;
            const total = 
                (item.inputs.large || 0) * item.units.large.cap +
                (item.inputs.small || 0) * item.units.small.cap +
                (item.inputs.loose || 0);
            return total;
        };

        const setAllZero = (item) => {
            item.inputs.large = 0;
            if(item.units.small.cap > 1) item.inputs.small = 0;
            item.inputs.loose = 0;
            saveToLocal();
        };

        const updateQty = (item, type, amount) => {
            if (item.inputs[type] === null) {
                item.inputs[type] = 0;
            }
            item.inputs[type] += amount;
            if (item.inputs[type] < 0) item.inputs[type] = 0;
            saveToLocal();
        };

        const saveToLocal = () => {
            const dataToSave = {};
            inventory.value.forEach(item => {
                dataToSave[item.code] = item.inputs;
            });
            localStorage.setItem('pharmacy_inventory_v9', JSON.stringify(dataToSave));
        };

        const filteredInventory = computed(() => {
            if (!searchQuery.value) return inventory.value;
            const q = searchQuery.value.toLowerCase();
            return inventory.value.filter(item => 
                item.name.toLowerCase().includes(q) || 
                item.code.toLowerCase().includes(q) ||
                item.shelf.toLowerCase().includes(q)
            );
        });

        const uncountedCount = computed(() => {
            return inventory.value.filter(item => !isItemComplete(item)).length;
        });

        const progressPercent = computed(() => {
            const total = inventory.value.length;
            const done = total - uncountedCount.value;
            return total === 0 ? 0 : (done / total) * 100;
        });

        const checkAndExport = () => {
            if (uncountedCount.value > 0) {
                const confirmed = confirm(`ç›®å‰å°šæœ‰ ${uncountedCount.value} ç­†æœªç›¤é»ã€‚\n\né€™æ˜¯ã€Œæ”¯æ´è—¥å¸«ã€æ¨¡å¼å—ï¼Ÿ\n(æŒ‰ã€Œç¢ºå®šã€åŒ¯å‡ºï¼Œæœªç›¤é»é …ç›®å°‡ç•™ç©º)`);
                if (!confirmed) return;
            }
            exportExcel();
        };

        const exportExcel = () => {
            const exportData = inventory.value.map(item => {
                const formatVal = (val) => val === null ? '' : val;
                
                return {
                    'è—¥å“ä»£ç¢¼': item.code,
                    'è—¥å“åç¨±': item.name,
                    'æ«ƒä½': item.shelf,
                    'å¤§åŒ…è£è¼¸å…¥': formatVal(item.inputs.large),
                    'å°åŒ…è£è¼¸å…¥': formatVal(item.inputs.small),
                    'é›¶æ•£è¼¸å…¥': formatVal(item.inputs.loose),
                    'ç¸½ç›¤é»é‡(æœ€å°å–®ä½)': isItemComplete(item) ? calculateTotal(item) : 'æœªç›¤é»',
                    'ç›¤é»äºº': isItemComplete(item) ? currentUser.value : '',
                    'ç›¤é»æ™‚é–“': isItemComplete(item) ? new Date().toLocaleString() : ''
                };
            });

            const ws = XLSX.utils.json_to_sheet(exportData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "ç›¤é»çµæœ");
            
            const date = new Date().toISOString().slice(0,10);
            const status = uncountedCount.value > 0 ? '_éƒ¨åˆ†æ”¯æ´' : '_å®Œæ•´';
            XLSX.writeFile(wb, `ç›¤é»å ±è¡¨_èª¿A${status}_${date}.xlsx`);
        };

        return {
            currentPage,
            currentUser,
            staffList,
            inventory,
            searchQuery,
            filteredInventory,
            uncountedCount,
            progressPercent,
            enterSystem,
            isItemComplete,
            calculateTotal,
            updateQty,
            setAllZero,
            checkAndExport
        };
    }
}).mount('#app');
</script>
</body>
</html>
